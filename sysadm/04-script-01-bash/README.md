# Домашнее задание к занятию "4.1. Командная оболочка Bash: Практические навыки"

## Обязательная задача 1

Есть скрипт:

```bash
a=1
b=2
c=a+b
d=$a+$b
e=$(($a+$b))
```

Какие значения переменным c,d,e будут присвоены? Почему?

| Переменная  | Значение | Обоснование                                                                                                                         |
| ------------- |----------|-------------------------------------------------------------------------------------------------------------------------------------|
| `c`  | a + b    | т.к. строковая переменная                                                                                                           |
| `d`  | 1 + 2    | a и b это простые числовые значения, а bash выводит выражение как последовательность переменных и знак + здесь выводится как текст. |
| `e`  | 3        | выражение заключено в двойные скобки и будет проведен расчет арифметического выражения                                              |

## Обязательная задача 2

На нашем локальном сервере упал сервис и мы написали скрипт, который постоянно проверяет его доступность, записывая дату
проверок до тех пор, пока сервис не станет доступным (после чего скрипт должен завершиться). В скрипте допущена ошибка,
из-за которой выполнение не может завершиться, при этом место на Жёстком Диске постоянно уменьшается. Что необходимо
сделать, чтобы его исправить:

```bash
while ((1==1)
do
	curl https://localhost:4757
	if (($? != 0))
	then
		date >> curl.log
	fi
done
```

### Ваш скрипт:

```bash
while ((1==1)) # не хватало скобки ")"
do
	curl https://localhost:4757
	if (($? != 0))
	  then
		date >> curl.log # можно использовать 'date > curl.log', тогда данные будут перезаписываться
		sleep 5 # установить паузу, например, 5 сек
	elif (($? == 0))
	  then 
	    echo "service is available" >> curl.log # если сервис доступен выводим сообщение
            break # и выходим
	fi
done
```

## Обязательная задача 3

Необходимо написать скрипт, который проверяет доступность трёх IP: `192.168.0.1`, `173.194.222.113`, `87.250.250.242`
по `80` порту и записывает результат в файл `log`. Проверять доступность необходимо пять раз для каждого узла.

### Ваш скрипт:

```bash
#!/bin/bash
ip=("192.168.0.1" "173.194.222.113" "87.250.250.242")
for i in ${ip[@]}; do #пройдем по всем элементам списка ip-адресов
  for j in {1..5}; do  # выполним команды 5 раз
      date >> ip.log
      curl -Is --connect-timeout 5 $i:80 >/dev/null
      if  (($? == 0))
      then
      echo $i "connect is good" >> ip.log
      elif (($? == 1))
      then
      echo $i "no connect" >> ip.log
      fi
  done
done
```

## Обязательная задача 4

Необходимо дописать скрипт из предыдущего задания так, чтобы он выполнялся до тех пор, пока один из узлов не окажется
недоступным. Если любой из узлов недоступен - IP этого узла пишется в файл error, скрипт прерывается.

### Ваш скрипт:

```bash
#!/bin/bash
ip=("192.168.0.1" "173.194.222.113" "87.250.250.242")
result=0
for i in ${ip[@]}
do #пройдем по всем элементам списка ip-адресов
    for j in {1..5}
    do  # выполним команды 5 раз
      date >> ip.log
      curl --connect-timeout 5 $i:80 >/dev/null
      result=$? # запишем результат вывода последней команды в переменную
      if  (( $result == 0))
      then
        echo $i "connect is good" >> ip.log
      elif (($? != 0))
      then
        echo $i >> error.log #  если узел не доступен - пишем ip  в  error  и
        exit                 # прерываем выполнение
      fi

    done
done
```